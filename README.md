# prob_robotics_demo
確率ロボティクス課題提出用リポジトリ
1. 自己位置推定 (Localization)ロボットの時刻 $t$ における状態（位置）を $\mathbf{x}_t$、移動指令を $\mathbf{u}_t$、観測値を $\mathbf{z}_t$ とします。MCL (Monte Carlo Localization)パーティクル群 $\{\mathbf{x}_t^{(i)}, w_t^{(i)}\}_{i=1}^N$ を用いて事後分布を近似します。予測 (Prediction): システムモデル $p(\mathbf{x}_t | \mathbf{x}_{t-1}, \mathbf{u}_t)$ からサンプリング。$$\mathbf{x}_t^{(i)} \sim p(\mathbf{x}_t | \mathbf{x}_{t-1}^{(i)}, \mathbf{u}_t)$$更新 (Update): 観測尤度に基づき重み $w$ を計算。$$w_t^{(i)} \propto p(\mathbf{z}_t | \mathbf{x}_t^{(i)})$$カルマンフィルタ (Kalman Filter)状態をガウス分布 $\mathcal{N}(\boldsymbol{\mu}_t, \boldsymbol{\Sigma}_t)$ で表現します。カルマンゲイン: $K_t = \boldsymbol{\Sigma}_t^- H^T (H \boldsymbol{\Sigma}_t^- H^T + R)^{-1}$状態更新: $\boldsymbol{\mu}_t = \boldsymbol{\mu}_t^- + K_t (\mathbf{z}_t - H \boldsymbol{\mu}_t^-)$2. クラスタリングと混合ガウス分布 (GMM)EMアルゴリズム潜在変数 $z_k$ を含む対数尤度を最大化します。E-Step (期待値): 負担率（Responsibility） $\gamma_{nk}$ の計算。$$\gamma_{nk} = \frac{\pi_k \mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k)}{\sum_{j=1}^K \pi_j \mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_j, \boldsymbol{\Sigma}_j)}$$M-Step (最大化): パラメータ $\{\pi_k, \boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k\}$ の更新。変分推論 (Variational Inference)混合比 $\boldsymbol{\pi}$ にディリクレ分布 $\text{Dir}(\boldsymbol{\pi} | \boldsymbol{\alpha})$ を導入し、変分下界（ELBO）を最大化することで事後分布を近似します。自動モデル選択の原理:データが割り当てられないクラスタ $k$ は、事後分布のパラメータ $\alpha_k$ が事前分布の $\alpha_0$（小さい値）に収束し、混合比の期待値 $E[\pi_k] \to 0$ となることで、不要なクラスタが自動的に消滅します。3. ベイズ回帰 (Bayesian Regression)線形モデル $y = \mathbf{w}^T \boldsymbol{\phi}(\mathbf{x})$ における重み $\mathbf{w}$ の事後分布 $p(\mathbf{w} | \mathbf{t})$ を求めます。事前分布: $p(\mathbf{w}) = \mathcal{N}(\mathbf{w} | \mathbf{0}, \alpha^{-1} \mathbf{I})$事後分布: $p(\mathbf{w} | \mathbf{t}) = \mathcal{N}(\mathbf{w} | \mathbf{m}_N, \mathbf{S}_N)$$$\mathbf{S}_N^{-1} = \alpha \mathbf{I} + \beta \mathbf{\Phi}^T \mathbf{\Phi}$$$$\mathbf{m}_N = \beta \mathbf{S}_N \mathbf{\Phi}^T \mathbf{t}$$予測分布 $p(t | \mathbf{x}, \mathbf{t})$ の分散が、データが存在しない領域で大きくなる（不確実性の可視化）のが特徴です。4. k-means各データ点 $\mathbf{x}_n$ を最も近い中心 $\boldsymbol{\mu}_k$ に割り当てる最小化問題です。$$J = \sum_{n=1}^N \sum_{k=1}^K r_{nk} \|\mathbf{x}_n - \boldsymbol{\mu}_k\|^2$$ここで $r_{nk} \in \{0, 1\}$ はハードな割り当てを示します。
